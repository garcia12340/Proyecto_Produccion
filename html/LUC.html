<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>LUC</title>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
   <!--=============== REMIXICONS ===============-->
   <link href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css" rel="stylesheet">
   <link rel="stylesheet" href="../css/index.css">
   <link rel="stylesheet" href="../css/luc.css">
</head>

<body>
   <!--=============== HEADER ===============-->
   <header class="header">
      <nav class="nav container">
         <div class="nav__data">
            <a href="../index.html" class="nav__logo">
               <i class="ri-planet-line"></i> Company
            </a>

            <div class="nav__toggle" id="nav-toggle">
               <i class="ri-menu-line nav__burger"></i>
               <i class="ri-close-line nav__close"></i>
            </div>
         </div>

         <!--=============== NAV MENU ===============-->
         <div class="nav__menu" id="nav-menu">
            <ul class="nav__list">
               <li><a href="../index.html" class="nav__link">Home</a></li>

               <!--=============== DROPDOWN 1 ===============-->
               <li class="dropdown__item">
                  <div class="nav__link">
                     Inventario <i class="ri-arrow-down-s-line dropdown__arrow"></i>
                  </div>

                  <ul class="dropdown__menu">
                     <li>
                        <a href="../html/CMC.html" class="dropdown__link">
                           <i class="ri-pie-chart-line"></i> Mantenimiento Correctivo
                        </a>
                     </li>

                     <li>
                        <a href="../html/EOQ.html" class="dropdown__link">
                           <i class="ri-arrow-up-down-line"></i> EOQ
                        </a>
                     </li>

                     <!--=============== DROPDOWN SUBMENU ===============-->
                     <li class="dropdown__subitem">
                        <div class="dropdown__link">
                           <i class="ri-bar-chart-line"></i> Control de Inventario <i
                              class="ri-add-line dropdown__add"></i>
                        </div>

                        <ul class="dropdown__submenu">
                           <li>
                              <a href="../html/CFP.html" class="dropdown__sublink">
                                 <i class="ri-refund-2-line"></i> Costo Fijo Por Pieza
                              </a>
                           </li>

                           <li>
                              <a href="../html/CPP.html" class="dropdown__sublink">
                                 <i class="ri-refund-2-line"></i> Costo Promedio Por Pieza
                              </a>
                           </li>

                           <li>
                              <a href="#" class="dropdown__sublink">
                                 <i class="ri-refund-2-line"></i> Refunds
                              </a>
                           </li>
                        </ul>
                     </li>
                  </ul>
               </li>

               <!--=============== DROPDOWN 2 ===============-->
               <li class="dropdown__item">
                  <div class="nav__link">
                     MRP <i class="ri-arrow-down-s-line dropdown__arrow"></i>
                  </div>

                  <ul class="dropdown__menu">
                     <li>
                        <a href="#" class="dropdown__link">
                           <i class="ri-pie-chart-line"></i>  Diagrama 1
                        </a>
                     </li>

                     <li>
                        <a href="#" class="dropdown__link">
                           <i class="ri-arrow-up-down-line"></i>  Diagrama 2
                        </a>
                     </li>

                  </ul>

               </li>

               <!--=============== DROPDOWN 3 ===============-->
               <li class="dropdown__item">
                  <div class="nav__link">
                    LTC - LUC <i class="ri-arrow-down-s-line dropdown__arrow"></i>
                  </div>

                  <ul class="dropdown__menu">
                     <li>
                        <a href="../html/LTC.html"  target="_blank" class="dropdown__link">
                           <i class="ri-pie-chart-line"></i> LTC
                        </a>
                     </li>

                     <li>
                        <a href="../html/LUC.html" target="_blank" class="dropdown__link">
                           <i class="ri-arrow-up-down-line"></i> LUC
                        </a>
                     </li>
                  </ul>

               </li>

               <!--=============== DROPDOWN 4 ===============-->
               <li class="dropdown__item">
                  <div class="nav__link">
                     Users <i class="ri-arrow-down-s-line dropdown__arrow"></i>
                  </div>

                  <ul class="dropdown__menu">
                     <li>
                        <a href="#" class="dropdown__link">
                           <i class="ri-user-line"></i> Profiles
                        </a>
                     </li>

                     <li>
                        <a href="#" class="dropdown__link">
                           <i class="ri-lock-line"></i> Accounts
                        </a>
                     </li>

                     <li>
                        <a href="#" class="dropdown__link">
                           <i class="ri-message-3-line"></i> Messages
                        </a>
                     </li>
                  </ul>
               </li>

               <li><a href="#" class="nav__link">Contact</a></li>
            </ul>
         </div>
      </nav>

</header>

<main>
   <h1>Método Del Menor Costo Unitario LUC</h1>
    <form id="lucForm">
        <label for="costHold">Costo de Ordenar:</label>
        <input type="number" id="costHold" step="0.01" required><br>

        <label for="costOrder">Costo de Mantenimiento:</label>
        <input type="number" id="costOrder" step="0.01" required><br>

        <label for="numWeeks">Número de Semanas:</label>
        <input type="number" id="numWeeks" required><br>

        <h3>Ingrese requerimientos brutos por semana:</h3>
        <div id="weeklyDemands"></div>

        <button type="submit">Calcular</button>
    </form>
    <div id="resultsTable"></div>
</main>

<!--=============== MAIN JS ===============-->
<script>
    document.getElementById('numWeeks').addEventListener('input', function () {
        const numWeeks = parseInt(this.value);
        const weeklyDemandsDiv = document.getElementById('weeklyDemands');
        weeklyDemandsDiv.innerHTML = '';
        for (let i = 1; i <= numWeeks; i++) {
            const input = document.createElement('input');
            input.type = 'number';
            input.id = 'week' + i;
            input.required = true;
            const label = document.createElement('label');
            label.htmlFor = 'week' + i;
            label.textContent = 'Semana ' + i + ':';
            weeklyDemandsDiv.appendChild(label);
            weeklyDemandsDiv.appendChild(input);
            weeklyDemandsDiv.appendChild(document.createElement('br'));
        }
    });

    document.getElementById('lucForm').addEventListener('submit', function (e) {
        e.preventDefault();
        const numWeeks = parseInt(document.getElementById('numWeeks').value);
        const costHold = parseFloat(document.getElementById('costHold').value);
        const costOrder = parseFloat(document.getElementById('costOrder').value);
        const demands = [];
        for (let i = 1; i <= numWeeks; i++) {
            demands.push(parseInt(document.getElementById('week' + i).value));
        }

        const results = calculateLUC(demands, costHold, costOrder);
        displayResults(results);
    });

    function calculateLUC(demands, costHold, costOrder) {
        let periods = [];
        let cumulativeUnits = 0;
        let cumulativePeriod = 0;
        let previousTotalCost = costHold;
        for (let i = 0; i < demands.length; i++) {
            cumulativeUnits += demands[i];
            cumulativePeriod += i + 1;
            let K = (i > 0) ? cumulativePeriod * i * costOrder : 0;
            let totalCost = (i === 0) ? costHold : previousTotalCost + K;
            previousTotalCost = totalCost;
            periods.push({
                period: cumulativePeriod,
                units: cumulativeUnits,
                costHold: costHold,
                K: K,
                totalCost: parseFloat(totalCost.toFixed(4)),
                costPerUnit: parseFloat((totalCost / cumulativeUnits).toFixed(4))
            });
        }
        return periods;
    }

    function displayResults(results) {
        const table = document.createElement('table');
        const headerRow = table.insertRow();
        const headers = ["Periodo", "Unidades", "S", "K", "Costo Total", "Costo unitario $ total/unidades"];
        headers.forEach(headerText => {
            const headerCell = document.createElement('th');
            headerCell.textContent = headerText;
            headerRow.appendChild(headerCell);
        });

        // Determine the two highest total cost values
        const totalCosts = results.map(r => r.totalCost);
        const highestTotalCosts = totalCosts.sort((a, b) => b - a).slice(0, 2);

        results.forEach(result => {
            const row = table.insertRow();
            row.className = highestTotalCosts.includes(result.totalCost) ? 'highlight' : '';
            Object.values(result).forEach(text => {
                const cell = row.insertCell();
                cell.textContent = text;
            });
        });
        const resultsDiv = document.getElementById('resultsTable');
        resultsDiv.innerHTML = '';
        resultsDiv.appendChild(table);
    }
</script>

</body>
</html>